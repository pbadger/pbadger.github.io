<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdn.pubnub.com/pubnub-3.7.14.min.js"></script>
    <script src="https://cdn.pubnub.com/webrtc/webrtc.js"></script>
  </head>
  <body>
    Bender Controls

    <div id="vid-box"></div>

    <script type="text/javascript">
      var video_out = document.getElementById("vid-box");

      const login = () => {
        console.log('pubnub logging in');
        var phone = window.phone = PHONE({
            number        : "bender", // listen on username line else Anonymous
            publish_key   : 'pub-c-e9f8ffa0-89df-40ec-8585-69be7bcb2dc1',
            subscribe_key : 'sub-c-0de5b164-8f57-11e6-8409-0619f8945a4f',
            ssl: true
        });

        phone.ready( () => {
          alert('pubnub ready')
        });

        phone.receive( (session) => {
            alert('call recieved on tablet')
            // phone.dial('operator');
            session.connected( (session) => { video_out.appendChild(session.video); });
            session.ended( () => { video_out.innerHTML=''; });
        });
      }
      login();

      setTimeout( () => {phone.dial('operator');}, 10000);
    </script>
  </body>
</html>